{% extends 'base_metrics.html' %}

{% block extra_metrics_head %}
    <script>
        function createChartJs(json, label, canvas_id, legend_id){
            var data = {
                labels : json.labels,
                datasets : [
                    {
                        label: label,
                        data : json.data,
                        fillColor: "rgba(220,220,220,0.2)",
                        strokeColor: "rgba(220,220,220,1)",
                        pointColor: "rgba(220,220,220,1)",
                        pointStrokeColor: "#fff",
                        pointHighlightFill: "#fff",
                        pointHighlightStroke: "rgba(220,220,220,1)"
                    }
                ]
            };

            var ctx = document.getElementById(canvas_id).getContext("2d");
            var line = new Chart(ctx).Line(data);
            var div_legend = document.getElementById(legend_id);
            div_legend.innerHTML = line.generateLegend();
        }

        function createIPCharts(json){
            createChartJs(
                {
                    labels: json.labels,
                    data: json.ip_data
                },
                'Chart.js, ip visiters',
                "canvas_ip_chartjs",
                "div_legend_ip_chartjs");

            createChartJs(
                {
                    labels: json.labels,
                    data: json.ip_uniq_data
                },
                'Chart.js, ip uniq visiters',
                "canvas_ip_uniq_chartjs",
                "div_legend_ip_uniq_chartjs");
        }

        function createCharts(){
            $.getJSON("{% url 'metrics:ip_data' %}", createIPCharts);
        }
        $(document).ready(function(){
            Chart.defaults.global.tooltipEvents = [];
            Chart.defaults.global.responsive = true;
            Chart.defaults.global.animation = false;
            createCharts();
        });
    </script>
{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
            <div id="div_legend_ip_chartjs"></div>
            <canvas id="canvas_ip_chartjs"></canvas>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
            <div id="div_legend_ip_uniq_chartjs"></div>
            <canvas id="canvas_ip_uniq_chartjs"></canvas>
        </div>
    </div>
{% endblock %}